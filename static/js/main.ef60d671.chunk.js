(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(e,t,n){},20:function(e,t,n){e.exports=n(35)},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(15),c=n(5),i=n.n(c),s=n(9),l=n(1);function u(e){var t=e.autoStart,n=e.duration,r=e.startdate,o=Object(a.useState)(r),c=Object(l.a)(o,2),i=c[0],s=c[1],u=Object(a.useState)(!1),d=Object(l.a)(u,2),f=d[0],m=d[1],b=Object(a.useRef)(),p=50;var g=Object(a.useRef)(),j=Object(a.useRef)(p),v=Object(a.useRef)();function O(){g.current||(g.current=setInterval(function(){return function(e){b.current+=e,s(b.current)}(j.current)},p),m(!0)),v.current=setTimeout(function(){h()},n)}function h(){console.log("toggle clock"),v.current&&clearTimeout(v.current),g.current?(m(!1),clearInterval(g.current),g.current=void 0):O()}return Object(a.useEffect)(function(){s((new Date).getTime()),console.log("date after setting: "+i),b.current=i,console.log("init date to: "+b.current),t&&(console.log("starting Timer... ("+n/1e3+" sec)"),O())},[]),{date:i,playing:f,togglePause:h,reset:function(){console.log("reset"),g.current&&(clearInterval(g.current),g.current=void 0,m(!1));var e=(new Date).getTime();j.current=p,s(e),b.current=e},increaseSpeed:function(){j.current=j.current>0?j.current*=2:j.current/=2,Math.abs(j.current)<p&&(j.current=p)},decreaseSpeed:function(){j.current=j.current>0?j.current/=2:j.current*=2,Math.abs(j.current)<p&&(j.current=-1*p)},forceDate:function(e){b.current=e}}}var d=n(4),f=n(3);var m=function(e){var t=e.duration,n=Object(d.useGlobal)("appdate"),o=Object(l.a)(n,2),c=o[0],i=o[1],s=u({autoStart:!1,duration:t,startdate:c}),m=s.date,b=(s.playing,s.togglePause),p=s.reset,g=s.increaseSpeed,j=s.decreaseSpeed,v=s.forceDate;Object(f.a)("t",b),Object(f.a)("r",p),Object(f.a)(".",g),Object(f.a)(",",j),Object(a.useEffect)(function(){i(m)},[m]),Object(a.useEffect)(function(){v(c)},[c]),Object(a.useEffect)(function(){v(c)},[]);var O=Object(a.useState)(),h=Object(l.a)(O,2),w=h[0],y=h[1];return r.a.createElement("div",{className:"ClockController",onClick:function(){console.log("pressed");var e=Date.now();w&&e-w<300?p():(y(e),b())}})},b=n(6),p=n(2),g=n.n(p),j=n(16),v=n.n(j);function O(e){var t=[];try{t=e.feed.entry.map(function(e){return function(e){function t(e){for(var t={},n=0;n<e.length;n++)t[e[n].name]=e[n].content;return t}try{var n={};e.date&&Object.assign(n,t(e.date)),e.int&&Object.assign(n,t(e.int)),e.double&&Object.assign(n,t(e.double)),e.str&&Object.assign(n,t(e.str));var a,r=n.size.split(" ");switch(r[1]){case"B":a=Math.round(parseFloat(r[0]));break;case"MB":a=Math.round(1024*parseFloat(r[0]));break;case"GB":a=Math.round(1024*parseFloat(r[0])*1024);break;case"TB":a=Math.round(1024*parseFloat(r[0])*1024*1024);break;default:a=Math.round(parseFloat(r[0]))}return{id:e.title,geometry:v()(n.footprint),type:"Feature",properties:{updated:new Date(n.ingestiondate),title:e.title,name:e.title,date:n.beginposition+"/"+n.endposition,links:{data:[{href:e.link[0].href}]},earthObservation:{parentIdentifier:"",status:"ARCHIVED",acquisitionInformation:[{platform:{platformShortName:n.platformname,platformSerialIdentifier:n.platformserialidentifier},sensor:{instrument:n.instrumentshortname,operationalMode:n.sensoroperationalmode},acquisitionParameter:{acquisitionStartTime:new Date(n.beginposition),acquisitionStopTime:new Date(n.endposition),relativePassNumber:parseInt(n.relativeorbitnumber),orbitNumber:parseInt(n.orbitnumber),startTimeFromAscendingNode:null,stopTimeFromAscendingNode:null,orbitDirection:n.orbitdirection}}],productInformation:{productType:n.producttype,size:a}}}}}catch(o){return console.log("error parsing item from dhus: "+o.message),{}}}(e)}).filter(function(e){return e!=={}})}catch(n){console.log(e),console.log("Error: "),console.log(n),t=[]}return{type:"FeatureCollection",id:"search",properties:{totalResults:e.feed["opensearch:totalResults"],startIndex:e.feed["opensearch:startIndex"]?e.feed["opensearch:startIndex"]:1,itemsPerPage:e.feed["opensearch:itemsPerPage"],title:"DHuS search response",updated:new Date},features:t}}var h=n(8),w=n.n(h);function y(e){var t=e.clon?e.clon:15.5,n=e.clat?e.clat:48,o=e.alt?e.alt:1e7,c=Object(a.useRef)(null);Object(f.a)("p",function(){m(function(e){console.log("prevProjection: "+e);var t=["3D","Equirectangular","Mercator"],n=(t.indexOf(e)+1)%t.length;switch(console.log("newProjection: "+t[n]),t[n]){case"3D":c.current.globe.projection=new g.a.ProjectionWgs84;break;case"Equirectangular":c.current.globe.projection=new g.a.ProjectionEquirectangular;break;case"Mercator":c.current.globe.projection=new g.a.ProjectionMercator;break;case"North Polar":c.current.globe.projection=new g.a.ProjectionPolarEquidistant("North");break;case"South Polar":c.current.globe.projection=new g.a.ProjectionPolarEquidistant("South");break;default:c.current.globe.projection=new g.a.ProjectionWgs84}return c.current.redraw(),t[n]})});var u=Object(a.useState)("3D"),m=Object(l.a)(u,2)[1];Object(f.a)("c",y);var p=Object(a.useState)([]),j=Object(l.a)(p,2),v=j[0],h=j[1];function y(){for(var e=0;e<v.length;e++)c.current.removeLayer(v[e]),console.log("removing json layers: "),console.log(v[e]);h([]),console.log(v),c.current.redraw()}Object(a.useEffect)(function(){console.log("geojson changed"),console.log(v)},[v]),Object(f.a)("a",function(){c.current.layers[3].enabled=!c.current.layers[3].enabled,c.current.redraw()}),Object(f.a)("s",function(){c.current.layers[2].enabled=!c.current.layers[2].enabled,c.current.redraw()}),Object(f.a)("n",function(){c.current.layers[1].enabled=!c.current.layers[1].enabled,c.current.redraw()}),Object(a.useEffect)(function(){console.log("useEffect (mount) in Map"),c.current=new g.a.WorldWindow(e.id);var a={service:"https://tiles.maps.eox.at/wms",layerNames:"s2cloudless-2018",numLevels:19,format:"image/png",size:256,sector:g.a.Sector.FULL_SPHERE,levelZeroDelta:new g.a.Location(90,90)},r={service:"https://tiles.maps.eox.at/wms",layerNames:"overlay_bright",numLevels:19,format:"image/png",size:256,sector:g.a.Sector.FULL_SPHERE,levelZeroDelta:new g.a.Location(90,90)};g.a.configuration.baseUrl=g.a.configuration.baseUrl.slice(0,-3);var i=new g.a.StarFieldLayer,s=new g.a.AtmosphereLayer("images/BlackMarble_2016_01deg.jpg");s.minActiveAltitude=5e6;for(var l=[{layer:new g.a.WmsLayer(a,""),enabled:!0},{layer:new g.a.WmsLayer(r,""),enabled:!1},{layer:i,enabled:e.starfield},{layer:s,enabled:e.atmosphere}],u=0;u<l.length;u++)l[u].layer.enabled=l[u].enabled,c.current.addLayer(l[u].layer);i.time=new Date(S),s.time=new Date(S),setTimeout(function(){c.current.goToAnimator.travelTime=1e3,c.current.goTo(new g.a.Position(n,t,o)),c.current.redraw()},2e3),c.current.redraw(),c.current.deepPicking=!0},[]);var E=Object(d.useGlobal)("appdate"),S=Object(l.a)(E,1)[0];Object(a.useEffect)(function(){c.current.layers[2].time=c.current.layers[3].time=new Date(S),c.current.redraw()},[S]);var N=function(){var e=[];e.S1="https://131.176.236.55/dhus/search?q=(%20beginposition:[{start}%20TO%20{end}]%20AND%20platformname:Sentinel-1%20AND%20producttype:GRD)&start=0&rows=100&sortedby=ingestiondate&order=desc&format=json",e.S2="https://131.176.236.55/dhus/search?q=(%20beginposition:[{start}%20TO%20{end}]%20AND%20platformname:Sentinel-2%20AND%20producttype:S2MSI1C)&start=0&rows=100&sortedby=ingestiondate&order=desc&format=json",e.S3="https://131.176.236.55/dhus/search?q=(%20beginposition:[{start}%20TO%20{end}]%20AND%20platformname:Sentinel-3%20AND%20(producttype:OL_1_ERR___%20OR%20producttype:SL_1_RBT___%20OR%20producttype:SR_1_SRA___))&start=0&rows=100&sortedby=ingestiondate&order=desc&format=json",e.S5P="https://s5phub.copernicus.eu/search?q=(%20beginposition:[{start}%20TO%20{end}]%20AND%20platformname:Sentinel-5 precursor%20AND%20(producttype:L1B_RA_BD1%20OR%20(producttype:L2__NO2___%20AND%20processingmode:Near real time)))&start=0&rows=100&sortedby=ingestiondate&order=desc&format=json",e.ENVISAT="https://eocat.esa.int/ngeo/catalogue/FEDEO-ENVISAT.ASA.IMP_1P/search?start={start}&stop={end}&format=json&count=50&startIndex=1";var t=Object(a.useState)({}),n=Object(l.a)(t,2),r=n[0],o=n[1],c=Object(a.useState)(!1),u=Object(l.a)(c,2),f=u[0],m=u[1],b=Object(d.useGlobal)("searchdate"),p=Object(l.a)(b,1)[0],g=Object(d.useGlobal)("mission"),j=Object(l.a)(g,1)[0],v=Object(a.useState)(""),h=Object(l.a)(v,2),y=h[0],E=h[1];return Object(a.useEffect)(function(){!function(){var e=Object(s.a)(i.a.mark(function e(){var t,n,a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return m(!0),console.log("Search: "+y),e.prev=2,e.next=5,fetch(y,{mode:"cors",credentials:"include"});case 5:return t=e.sent,e.next=8,t.json();case 8:n=e.sent,a="ENVISAT"===j?n:O(n),console.log("totalResults: "+a.properties.totalResults),o(a),m(!1),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),console.log("Didn't recieve a json !"),m(!1);case 19:case"end":return e.stop()}},e,null,[[2,15]])}));return function(){return e.apply(this,arguments)}}()(y)},[y]),Object(a.useEffect)(function(){console.log("DataHub ready. "+j)},[]),Object(a.useEffect)(function(){console.log("Searching Catalogue for: "+j);var t=e[j];try{t=(t=t.replace("{start}",w()(new Date(p-54e5),"isoUtcDateTime"))).replace("{end}",w()(new Date(p+54e5),"isoUtcDateTime")),E(t)}catch(n){console.log("Not a JULIAN date !")}},[p,j]),{geojsonResults:r,loading:f}}().geojsonResults;Object(a.useEffect)(function(){console.log("datahub in use"),console.log(N);try{!function(e){var t=new g.a.RenderableLayer("GeoJSON_"+new Date);y(),c.current.addLayer(t),new g.a.GeoJSONParser(e).load(function(){h(function(e){return[].concat(Object(b.a)(e),[t])}),c.current.redraw()},function(e,t){var n={},a=new g.a.PlacemarkAttributes(null);return a.imageScale=10,a.imageColor=new g.a.Color(0,1,1,.2),a.labelAttributes.offset=new g.a.Offset(g.a.OFFSET_FRACTION,5,g.a.OFFSET_FRACTION,5),e.isPointType()||e.isMultiPointType()?n.attributes=new g.a.PlacemarkAttributes(a):e.isLineStringType()||e.isMultiLineStringType()?(n.attributes.drawOutline=!0,n.attributes.outlineColor=new g.a.Color(.1*n.attributes.interiorColor.red,.3*n.attributes.interiorColor.green,.7*n.attributes.interiorColor.blue,1),n.attributes.outlineWidth=1):(e.isPolygonType()||e.isMultiPolygonType())&&(n.attributes=new g.a.ShapeAttributes(null),n.attributes.interiorColor=new g.a.Color(1,0,0,.2),n.attributes.outlineColor=new g.a.Color(1,0,0,.3)),n},t)}(N)}catch(e){console.log("error on geojson parsing"),console.log(e)}},[N]);return r.a.createElement("canvas",{id:e.id,style:{background:"inherit",position:"fixed",width:"inherit",height:"inherit"}})}n(14);var E=function(){var e=Object(d.useGlobal)("mission"),t=Object(l.a)(e,2),n=t[0],o=t[1];return Object(f.a)("1",function(){o("S1")}),Object(f.a)("2",function(){o("S2")}),Object(f.a)("3",function(){o("S3")}),Object(f.a)("5",function(){o("S5P")}),Object(f.a)("6",function(){o("ENVISAT")}),Object(a.useEffect)(function(){console.log("Mission changed to: "+n)},[n]),r.a.createElement("div",{className:"MissionSelector"},r.a.createElement("div",{className:"Circle"},r.a.createElement("img",{className:"MissionIcon",src:"./images/s1_black.png",alt:"",onClick:function(){return o("S1")}})),r.a.createElement("div",{className:"Circle"},r.a.createElement("img",{className:"MissionIcon",src:"./images/s2_black.png",alt:"",onClick:function(){return o("S2")}})),r.a.createElement("div",{className:"Circle"},r.a.createElement("img",{className:"MissionIcon",src:"./images/s3_black.png",alt:"",onClick:function(){return o("S3")}})),r.a.createElement("div",{className:"Circle"},r.a.createElement("img",{className:"MissionIcon",src:"./images/s5p_black.png",alt:"",onClick:function(){return o("S5P")}})),r.a.createElement("div",{className:"MissionLabel"},n))},S=n(17),N=n.n(S),T=n(18),D=(n(32),n(12)),k=n(19),C=(n(33),n(11));var M=function(e){var t,n=(e.max-e.min)/(40*(e.max-e.min)/864e5),o=e.min,c=o+(e.max-e.min)/n,i=0;e.vertical?(i=c-o,t=100):(t=c-o,i=100);var s=Object(d.useGlobal)("appdate"),u=Object(l.a)(s,2),f=u[0],m=u[1],b=Object(d.useGlobal)("searchdate"),p=Object(l.a)(b,2)[1],g=Object(a.useState)(new Date),j=Object(l.a)(g,2),v=j[0],O=j[1],h=Object(a.useState)(!1),w=Object(l.a)(h,2),y=w[0],E=w[1],S=Object(a.useRef)();S.current=e.vertical;var N=Object(a.useRef)(),T=Object(D.b)(function(){return{xy:[0,0]}}),M=Object(l.a)(T,2),_=M[0].xy,x=M[1],P=Object(k.a)({onDrag:function(e){var t=e.down,a=e.delta,r=e.velocity,c=e.active,i=e.direction,s=(e.wheeling,e.time,e.first,e.last,e.temp),l=void 0===s?{xy:_.getValue(),deltaOffset:[0,0],lastNewxy:[0,0],deltaFactor:[1,1],lastStep:1,lastIncrement:0,lastDown:!1}:s;if(Object(C.scale)(i,r),r=r<.15?0:r,t!=l.lastDown&&(console.log("set true"),E(!0)),l.lastDown=t,S.current){var u=N.current.parentElement.offsetHeight,d=1,f=1;a[0]<-30&&(d=864e5/n,f=10),a[0]<-80&&(d=2592e6/n,f=15),a[0]<-130&&(d=31536e6/n,f=30),d!==l.lastStep&&(console.log("Step changed from: "+l.lastStep+" to: "+d),l.deltaOffset=a,l.xy=l.lastNewxy),a=Object(C.sub)(a,l.deltaOffset);var m=[Math.round(a[0]/f)*d,Math.round(a[1]/f)*d];t&&(r=0);var b=Object(C.add)(Object(C.scale)(m,Math.pow(r+1,2.5)),l.xy);d!==l.lastStep&&(l.xy=b,l.lastStep=d),l.lastNewxy=b;var g=N.current.parentElement.offsetTop+N.current.parentElement.offsetHeight/2,j=-N.current.offsetHeight+N.current.parentElement.offsetHeight/2;b[1]=b[1]>g?g:b[1],b[1]=b[1]<j?j:b[1],x({xy:b,config:t?{mass:1,tension:1200,friction:40,precision:.01}:{mass:1,tension:200,friction:40,precision:1},immediate:t,onRest:function(e){var a=e.xy;t||c||(E(!1),console.log("set to false")),t||p(o+(-a[1]+u/2)*n)},onFrame:function(e){var t=e.xy;O(o+(-t[1]+u/2)*n)}})}return l}}),A=Object(a.useState)(""),L=Object(l.a)(A,2),R=L[0],I=L[1];return Object(a.useLayoutEffect)(function(){I(function(){for(var t,a,o,c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],i=0,s=0,l=[],u=e.vertical?"DayTic-v":"DayTic",d=e.vertical?"MonthTic-v":"MonthTic",f=e.vertical?"YearTic-v":"YearTic",m=e.min;m<=e.max;m+=36e5)t=new Date(m).getUTCDate(),a=c[new Date(m).getUTCMonth()],new Date(m).getUTCHours(),i=new Date(m).getUTCFullYear(),t!==o&&l.push({class:u,pos:(m-e.min)/n,label:t}),a!==s&&(l.push({class:d,pos:(m-e.min)/n,label:a}),l.push({class:f,pos:(m-e.min)/n,label:i})),o=t,s=a;return l.map(function(t){return r.a.createElement("div",{className:t.class,key:t.class+t.pos,style:e.vertical?{top:t.pos}:{left:t.pos}},t.label)})}(e.vertical))},[e.vertical]),Object(a.useLayoutEffect)(function(){var t=0;y||(e.vertical?(t=(o-f)/n+N.current.parentElement.offsetHeight/2,x({xy:[0,t],config:{tension:1200,friction:40},onFrame:null,onRest:null})):(t=(o-f)/n+N.current.parentElement.offsetWidth/2,x({xy:[t,0],config:{tension:1200,friction:40},onFrame:null,onRest:null})))},[f,R]),Object(a.useEffect)(function(){m(v)},[v]),Object(a.useLayoutEffect)(function(){console.log("zoom changed to: "+e.zoom)},[e.zoom]),r.a.createElement("div",{className:e.vertical?"Mask-v":"Mask"},r.a.createElement("div",{className:"TriangleContainer"},r.a.createElement("svg",{height:"40",width:"20",className:"Triangle"},r.a.createElement("polygon",{points:"20,5 20,35 12,20"}))),r.a.createElement("div",{className:"TimeContainer",ref:N},r.a.createElement(D.a.div,Object.assign({className:"TimeScale"},P(),{style:{width:t,height:i,transform:_.interpolate(function(e,t){return"translate3d(0px,".concat(t,"px,0)")})}}),R)))};n(34);var _=function(e){e.highlight;var t=e.date;return r.a.createElement("div",{className:"LabelCountainer"},r.a.createElement("div",{className:"Line",key:"line"},"____"),r.a.createElement("div",{className:"DayLabel",key:"day"},w()(t,"UTC:dd")),r.a.createElement("div",{className:"YearLabel",key:"year"},w()(t,"UTC:yyyy")),r.a.createElement("div",{className:"MonthLabel",key:"month"},w()(t,"UTC:mmm")),r.a.createElement("div",{className:"TimeLabel",key:"time"},w()(t,"UTC:HH:MM:ss")))};var x=function(e){var t=e.action,n=Object(a.useState)(!0),o=Object(l.a)(n,2),c=o[0],i=o[1];return Object(f.a)("d",function(){i(function(e){return!e})}),Object(a.useEffect)(function(){console.log("Debug Overlay: press D "),console.log("action: "+t)},[]),r.a.createElement("div",{className:"debug",style:{display:c?"inline":"hidden",width:30,height:"100%"}},r.a.createElement("div",{className:"ContinuousScroll",style:{top:"70%",right:0,width:30,height:"100%",background:"rgba(22, 22, 20, 0.74)"}}))},P=function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],o=t[1],c=Object(d.useGlobal)("appdate"),u=Object(l.a)(c,1)[0],b=Object(d.useGlobal)("searchdate"),p=(Object(l.a)(b,1)[0],Object(a.useState)(new Date("2000-04-10").getTime())),g=Object(l.a)(p,2),j=g[0],v=(g[1],Object(a.useState)(new Date("2019-12-31").getTime())),O=Object(l.a)(v,2),h=O[0],w=(O[1],Object(a.useState)(!0)),S=Object(l.a)(w,2),D=S[0],k=S[1];Object(f.a)("h",function(){k(function(e){return!e})}),Object(a.useEffect)(function(){var e=function(){return new Promise(function(e){setTimeout(function(){var t=Math.ceil(10*Math.random());console.log("mockApi done"),e(t)},2e3)})};function t(){return(t=Object(s.a)(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=5;break}return t.next=3,e();case 3:t.sent,o(!0);case 5:case"end":return t.stop()}},t)}))).apply(this,arguments)}!function(){t.apply(this,arguments)}()},[]);var C=Object(a.useState)(!1),P=Object(l.a)(C,2),A=P[0],L=P[1],R=Object(T.a)(window.document.body),I=(R.isFullscreen,R.toggleFullscreen);return Object(f.a)("f",I),r.a.createElement("div",{className:"App"},r.a.createElement(N.a,{enabled:A,onChange:function(){A||L(!1)}},r.a.createElement("div",{className:"DateTimeLabel"},r.a.createElement(_,{vertical:D,date:u})),r.a.createElement("div",{className:"ClockController"},r.a.createElement(m,{duration:"600000"})),r.a.createElement("div",{className:"Globe"},r.a.createElement(y,{id:"globe",starfield:"true",astmosphere:"false"})),r.a.createElement("div",{className:D?"TimeSelectorv":"TimeSelectorh"},r.a.createElement(M,{min:j,max:h,vertical:D})),r.a.createElement(E,{mission:"S1"}),r.a.createElement(x,{action:"Bonjour"})))};var A=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function L(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}console.log("init global: "+(new Date).getTime()),Object(d.setGlobal)({appdate:(new Date).getTime()}),Object(d.setGlobal)({searchdate:(new Date).getTime()}),Object(d.setGlobal)({mission:"S1"}),Object(o.render)(r.a.createElement(P,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/reactwww",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/reactwww","/service-worker.js");A?function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):L(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e):L(e)})}}()}},[[20,1,2]]]);
//# sourceMappingURL=main.ef60d671.chunk.js.map